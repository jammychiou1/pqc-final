#include "rader_outer/base_mul.h"

// 204 entries
static int16_t __attribute__((aligned (16))) basemul_full_table[256] = {
    1, 7, -1, -7, -311, -2220, 311, 2220,
    310, 2213, -310, -2213, 1152, 8222, -1152, -8222,
    -174, -1242, 174, 1242, -978, -6980, 978, 6980,
    305, 2177, -305, -2177, 1556, 11106, -1556, -11106,
    -1861, -13283, 1861, 13283, -2147, -15324, 2147, 15324,
    2022, 14432, -2022, -14432, 125, 892, -125, -892,
    1205, 8601, -1205, -8601, 1707, 12184, -1707, -12184,
    1679, 11984, -1679, -11984, 1678, 11977, -1678, -11977,
    1516, 10820, -1516, -10820, 1397, 9971, -1397, -9971,
    245, 1749, -245, -1749, 1852, 13219, -1852, -13219,
    -2097, -14967, 2097, 14967, 2189, 15624, -2189, -15624,
    -1311, -9357, 1311, 9357, -878, -6267, 878, 6267,
    1269, 9057, -1269, -9057, 167, 1192, -167, -1192,
    -1436, -10249, 1436, 10249, 1950, 13918, -1950, -13918,
    -438, -3126, 438, 3126, -1512, -10792, 1512, 10792,
    1401, 10000, -1401, -10000, 434, 3098, -434, -3098,
    -1835, -13097, 1835, 13097, -2080, -14846, 2080, 14846,
    -451, -3219, 451, 3219, -2060, -14703, 2060, 14703,
    342, 2441, -342, -2441, -769, -5489, 769, 5489,
    427, 3048, -427, -3048, -842, -6010, 842, 6010,
    175, 1249, -175, -1249, 667, 4761, -667, -4761,
    -1283, -9157, 1283, 9157, -404, -2884, 404, 2884,
    1687, 12041, -1687, -12041, 286, 2041, -286, -2041,
    -1717, -12255, 1717, 12255, 1431, 10214, -1431, -10214,
    -1080, -7708, 1080, 7708, 737, 5260, -737, -5260,
    343, 2448, -343, -2448
};

void __asm_weighted16x16(int16_t*, int16_t*, int16_t*, int16_t*);

void base_mul(int16_t in1_ntt[1632], int16_t in2_ntt[1632], int16_t out_ntt[1632]) {
  __asm_weighted16x16(out_ntt, in1_ntt, in2_ntt, basemul_full_table);
}
